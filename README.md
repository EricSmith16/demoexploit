Hey.

Recently Valve released an update for CS 1.6 beta, build 7960. They didn't provide changelog, so I had to find all changes myself. It turned out that they updated the logic for dem files processing, namely added protection, that closes the possibility of executing assembler code on the client side of the engine. This prompted me to write a "compiler" of such broken dem file, that would write a shellcode on the stack and transfer of the program control to it. The compiler have been written, but it's not universal (it doesn't always work) and works only on one specific OS. I didn't use the "NOP sled" trick, but simply rewrote the return address where theoretically the shellcode is located. The shellcode itself simply shows the message with the text and closes the game.

Since this exploit can be considered fixed, then without any remorse, I upload the source code of the implementation of this compiler in open access for educational purposes.

It seems that the exploit works more or less stably only on Windows 10 systems, on other systems the client will simply crash, and the shellcode will not be executed. Nevertheless, the proof of the exploit's work is presented, and that's enough.

![Alt Text](https://media.giphy.com/media/3dfiddCdZF33JzI0IX/giphy.gif)